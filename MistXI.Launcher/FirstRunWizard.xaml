<Window x:Class="MistXI.Launcher.FirstRunWizard"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MistXI Launcher - First Time Setup" 
        Height="700" Width="900"
        WindowStartupLocation="CenterScreen"
        Background="{StaticResource Mist.Background}"
        ResizeMode="CanResize"
        MinHeight="600" MinWidth="900">
  
  <Grid Margin="32">
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="300"/>
      <ColumnDefinition Width="*"/>
    </Grid.ColumnDefinitions>

    <!-- Left Side - Branding -->
    <Border Grid.Column="0" 
            Background="{StaticResource Mist.Panel}"
            CornerRadius="20"
            Padding="20"
            Margin="0,0,12,0">
      <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
        <Image Source="pack://application:,,,/Assets/Vertical Logo.png" 
               Height="200" Stretch="Uniform" Margin="0,0,0,24"/>
        
        <TextBlock Style="{StaticResource Mist.Caption}" 
                   TextWrapping="Wrap"
                   HorizontalAlignment="Center"
                   TextAlignment="Center"
                   Margin="0,0,0,20"
                   Text="Classic 75-era Vana'diel awaits. Let's get you set up in just a few moments."/>

        <Border Background="{StaticResource Mist.Panel2}" 
                CornerRadius="12" 
                Padding="14"
                Margin="0,0,0,0">
          <StackPanel>
            <TextBlock FontWeight="SemiBold" 
                       Text="Quick Setup Steps:" 
                       Margin="0,0,0,10"
                       HorizontalAlignment="Center"
                       Foreground="{StaticResource Mist.Accent}"/>
            <TextBlock Style="{StaticResource Mist.Caption}" 
                       TextWrapping="Wrap" 
                       Margin="0,0,0,6"
                       TextAlignment="Center"
                       Text="1ï¸âƒ£ Locate FFXI installation"/>
            <TextBlock Style="{StaticResource Mist.Caption}" 
                       TextWrapping="Wrap" 
                       Margin="0,0,0,6"
                       TextAlignment="Center"
                       Text="2ï¸âƒ£ PlayOnline Viewer setup"/>
            <TextBlock Style="{StaticResource Mist.Caption}" 
                       TextWrapping="Wrap"
                       TextAlignment="Center"
                       Text="3ï¸âƒ£ Start playing!"/>
          </StackPanel>
        </Border>
      </StackPanel>
    </Border>

    <!-- Right Side - Setup Content -->
    <Grid Grid.Column="1">
      <Grid.RowDefinitions>
        <RowDefinition Height="*"/>
        <RowDefinition Height="Auto"/>
      </Grid.RowDefinitions>

      <!-- Content Area -->
      <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto">
        <StackPanel>
          
          <!-- Step 1: FFXI Location -->
          <Border Style="{StaticResource Mist.Card}" Margin="0,0,0,16">
            <StackPanel>
              <TextBlock Style="{StaticResource Mist.H2}" 
                         Text="Step 1: FINAL FANTASY XI Location"
                         Foreground="{StaticResource Mist.Accent}"/>
              <TextBlock Style="{StaticResource Mist.Caption}" 
                         Margin="0,8,0,16" 
                         TextWrapping="Wrap"
                         Text="We'll try to find FFXI automatically. If we can't find it, you can browse to locate it or download it."/>

              <Border Background="{StaticResource Mist.Panel2}" 
                      CornerRadius="12" 
                      Padding="16">
                <StackPanel>
                  <TextBlock x:Name="DetectionStatusText" 
                             FontWeight="SemiBold"
                             FontSize="14"
                             Foreground="{StaticResource Mist.Accent}"
                             Text="ðŸ” Searching for FFXI installation..."
                             Margin="0,0,0,16"/>
                  
                  <TextBlock Text="FFXI Installation Path:" 
                             FontWeight="SemiBold"
                             Margin="0,0,0,6"/>
                  <DockPanel Margin="0,0,0,8">
                    <Button x:Name="BrowseButton" 
                            Style="{StaticResource Mist.SecondaryButton}" 
                            Margin="10,0,0,0" 
                            DockPanel.Dock="Right"
                            Click="BrowseButton_Click"
                            Padding="16,10">Browse...</Button>
                    <TextBox x:Name="FfxiPathBox" 
                             Style="{StaticResource Mist.TextBox}"
                             FontSize="13"
                             TextChanged="FfxiPathBox_TextChanged"/>
                  </DockPanel>

                  <TextBlock x:Name="ValidationText" 
                             Style="{StaticResource Mist.Caption}"
                             Foreground="{StaticResource Mist.TextDim}"
                             FontSize="13"
                             Margin="0,0,0,12"/>

                  <Button x:Name="DownloadInstallButton"
                          Style="{StaticResource Mist.SecondaryButton}"
                          Click="DownloadInstall_Click"
                          Visibility="Collapsed"
                          HorizontalAlignment="Left"
                          Padding="16,10">
                    <StackPanel Orientation="Horizontal">
                      <TextBlock Text="ðŸ“¥ " FontSize="16" Margin="0,0,8,0"/>
                      <TextBlock Text="Download &amp; Install FFXI (3.5 GB)"/>
                    </StackPanel>
                  </Button>
                  
                  <ProgressBar x:Name="InstallerProgressBar"
                               Height="24"
                               Minimum="0"
                               Maximum="100"
                               Value="0"
                               Margin="0,12,0,0"
                               Visibility="Collapsed"/>
                  
                  <TextBlock x:Name="InstallerStatusText"
                             Style="{StaticResource Mist.Caption}"
                             Margin="0,8,0,0"
                             TextWrapping="Wrap"
                             Visibility="Collapsed"/>
                  
                  <Button x:Name="LaunchSetupButton"
                          Style="{StaticResource Mist.PrimaryButton}"
                          Click="LaunchSetup_Click"
                          Visibility="Collapsed"
                          HorizontalAlignment="Left"
                          Margin="0,12,0,0"
                          Padding="16,10">
                    <StackPanel Orientation="Horizontal">
                      <TextBlock Text="ðŸš€ " FontSize="16" Margin="0,0,8,0"/>
                      <TextBlock Text="Launch FFXI Setup Wizard"/>
                    </StackPanel>
                  </Button>
                </StackPanel>
              </Border>
            </StackPanel>
          </Border>

          <!-- Step 2: PlayOnline Viewer -->
          <Border Style="{StaticResource Mist.Card}" Margin="0,0,0,16">
            <StackPanel>
              <TextBlock Style="{StaticResource Mist.H2}" 
                         Text="Step 2: PlayOnline Viewer"
                         Foreground="{StaticResource Mist.Accent}"/>
              
              <TextBlock Style="{StaticResource Mist.Caption}" 
                         Margin="0,8,0,16" 
                         TextWrapping="Wrap"
                         Text="Required for the automated patching process and the 'Copy Data Folder' feature."/>

              <Border Background="{StaticResource Mist.Panel2}" 
                      CornerRadius="12" 
                      Padding="16">
                <StackPanel>
                  <TextBlock Text="PlayOnline Viewer Path:" 
                             FontWeight="SemiBold"
                             Margin="0,0,0,6"/>
                  <DockPanel>
                    <Button x:Name="BrowsePolButton" 
                            Style="{StaticResource Mist.SecondaryButton}" 
                            Margin="10,0,0,0" 
                            DockPanel.Dock="Right"
                            Click="BrowsePol_Click"
                            Padding="16,10">Browse...</Button>
                    <TextBox x:Name="PolPathBox" 
                             Style="{StaticResource Mist.TextBox}"
                             FontSize="13"
                             Foreground="{StaticResource Mist.TextDim}"
                             TextChanged="PolPathBox_TextChanged"/>
                  </DockPanel>
                  
                  <TextBlock x:Name="PolValidationText" 
                             Style="{StaticResource Mist.Caption}" 
                             Margin="0,8,0,0"
                             TextWrapping="Wrap"/>
                  
                  <!-- Re-Detect Button (for both paths) -->
                  <Button x:Name="ReDetectButton" 
                          Style="{StaticResource Mist.SecondaryButton}" 
                          Click="ReDetect_Click"
                          HorizontalAlignment="Center"
                          Margin="0,16,0,0"
                          Padding="24,12">
                    <StackPanel Orientation="Horizontal">
                      <TextBlock Text="ðŸ” " FontSize="16" Margin="0,0,8,0"/>
                      <TextBlock Text="Re-Detect Both Paths"/>
                    </StackPanel>
                  </Button>
                </StackPanel>
              </Border>
            </StackPanel>
          </Border>

          <!-- Step 3: Ready -->
          <Border Style="{StaticResource Mist.Card}">
            <StackPanel>
              <TextBlock Style="{StaticResource Mist.H2}" 
                         Text="Step 3: Ready to Play!"
                         Foreground="{StaticResource Mist.Accent}"/>
              <TextBlock Style="{StaticResource Mist.Caption}" 
                         Margin="0,8,0,16" 
                         TextWrapping="Wrap"
                         Text="Once you click 'Start Playing', MistXI will handle everything automatically."/>

              <Border Background="{StaticResource Mist.Panel2}" 
                      CornerRadius="12" 
                      Padding="16">
                <StackPanel>
                  <TextBlock FontWeight="SemiBold" 
                             Text="What happens next:" 
                             Margin="0,0,0,12"
                             Foreground="{StaticResource Mist.Accent}"/>
                  <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                    <TextBlock Text="âœ“ " 
                               FontSize="16" 
                               Foreground="{StaticResource Mist.Accent}" 
                               Margin="0,0,8,0"/>
                    <TextBlock Style="{StaticResource Mist.Caption}" 
                               TextWrapping="Wrap"
                               Text="Download Ashita v4 (game launcher)"/>
                  </StackPanel>
                  <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                    <TextBlock Text="âœ“ " 
                               FontSize="16" 
                               Foreground="{StaticResource Mist.Accent}" 
                               Margin="0,0,8,0"/>
                    <TextBlock Style="{StaticResource Mist.Caption}" 
                               TextWrapping="Wrap"
                               Text="Configure XiLoader for MistXI servers"/>
                  </StackPanel>
                  <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                    <TextBlock Text="âœ“ " 
                               FontSize="16" 
                               Foreground="{StaticResource Mist.Accent}" 
                               Margin="0,0,8,0"/>
                    <TextBlock Style="{StaticResource Mist.Caption}" 
                               TextWrapping="Wrap"
                               Text="Save your credentials securely (optional)"/>
                  </StackPanel>
                  <StackPanel Orientation="Horizontal">
                    <TextBlock Text="âœ“ " 
                               FontSize="16" 
                               Foreground="{StaticResource Mist.Accent}" 
                               Margin="0,0,8,0"/>
                    <TextBlock Style="{StaticResource Mist.Caption}" 
                               TextWrapping="Wrap"
                               Text="Launch and play in minutes!"/>
                  </StackPanel>
                </StackPanel>
              </Border>
            </StackPanel>
          </Border>

        </StackPanel>
      </ScrollViewer>

      <!-- Footer Buttons -->
      <DockPanel Grid.Row="1" Margin="0,16,0,0">
        <Button x:Name="CancelButton" 
                Style="{StaticResource Mist.SecondaryButton}"
                Click="Cancel_Click"
                DockPanel.Dock="Left"
                Padding="20,12">Cancel</Button>
        
        <Button x:Name="FinishButton" 
                Style="{StaticResource Mist.PrimaryButton}"
                Click="Finish_Click"
                IsEnabled="False"
                DockPanel.Dock="Right"
                Padding="24,12"
                FontSize="16">
          <StackPanel Orientation="Horizontal">
            <TextBlock Text="Start Playing " VerticalAlignment="Center"/>
            <TextBlock Text="â†’" FontSize="20" Margin="8,0,0,0" VerticalAlignment="Center"/>
          </StackPanel>
        </Button>
      </DockPanel>
    </Grid>
  </Grid>
</Window>
